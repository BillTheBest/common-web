(function(){var d={pageviewsEventName:"pageviews",clicksEventName:"clicks",formSubmissionsEventName:"form-submissions",callbackTimeout:1000,globalProperties:{page_url:window.location.href,referrer_url:document.referrer}};var e={options:d};e.addGlobalProperties=function(g){$.extend(e.options.globalProperties,g)};e.trackSession=function(l,k){if(typeof(l)!=="string"){l="common_web_guid"}var j=document.cookie.split("; ");var g=null;for(var h=0;h<j.length;h++){cookieParts=j[h].split("=");if(cookieParts[0]===l){g=cookieParts[1];break}}if(g===null){if(typeof(k)==="string"){g=k}else{genSub=function(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)};g=genSub()+genSub()+"-"+genSub()+"-"+genSub()+"-"+genSub()+"-"+genSub()+genSub()+genSub()}expiration_date=new Date();expiration_date.setFullYear(expiration_date.getFullYear()+1);cookie_string=l+"="+g+"; path/; expires="+expiration_date.toGMTString();document.cookie=cookie_string}e.addGlobalProperties({guid:g});return g};e.trackPageview=function(i){var g=e.options.globalProperties;var h=$.extend(true,{},g,a(i));e.Callback(e.options.pageviewsEventName,h)};e.trackClicks=function(h,g){if(typeof h==="undefined"){h=$("a")}$.each(h,function(i,j){$(j).on("click",function(m){var o=e.options.callbackTimeout;var l=f(m,j,g);var n=j.href&&j.target!=="_blank"&&!b(m);var k=function(){};if(n){k=function(){window.location.href=j.href};m.preventDefault();setTimeout(function(){window.location.href=j.href},o)}e.Callback(d.clicksEventName,l,k)})})};e.trackClicksPassive=function(h,g){$.each(h,function(i,j){$(j).on("click",function(l){var k=f(l,j,g);e.Callback(d.clicksEventName,k)})})};e.trackFormSubmissions=function(h,g){$.each(h,function(i,j){var l=e.options.callbackTimeout;var k=false;$(j).on("submit",function(o){var n=c(o,j,g);var p=true;var m=function(){};if(p){m=function(){if(!k){k=true;j.submit()}};o.preventDefault();setTimeout(function(){k=true;j.submit()},l)}e.Callback(d.formSubmissionsEventName,n,m)})})};e.Transformations={eventToProperties:function(h){var g={};g.timestamp=h.timestamp;g.type=h.type;g.metaKey=h.metaKey;return g},elementToProperties:function(i,j){var h=j||{};h.tagName=i.tagName;if(i.tagName==="A"){h.text=i.innerText}$(i.attributes).each(function(l,k){h[k.nodeName]=k.value});var g=$(i).attr("class");if(g){h.classes=g.split(/\s+/)}h.path=$(i).getPath();return h},formElementToProperties:function(g){var h={};h.form_values=$("#"+g.id).serializeArray();return this.elementToProperties(g,h)}};function f(l,j,k){var h=e.options.globalProperties;var i=$.extend(true,{},h,a(k,[l,j]));var m={element:e.Transformations.elementToProperties(j,null)};var g={event:e.Transformations.eventToProperties(l)};return $.extend(true,{},i,m,g)}function c(l,j,k){var h=e.options.globalProperties;var i=$.extend(true,{},h,a(k,[l,j]));var m={element:e.Transformations.formElementToProperties(j)};var g={event:e.Transformations.eventToProperties(l)};return $.extend(true,{},i,m,g)}function a(h,g){if(typeof h==="function"){return h.apply(window,g)}else{return h}}function b(g){return g.metaKey||g.altKey||g.ctrlKey||g.shiftKey}jQuery.fn.extend({getPath:function(h){if(typeof h=="undefined"){h=""}if(this.is("html")){return"html"+h}var i=this.get(0).nodeName.toLowerCase();var j=this.attr("id"),g=this.attr("class");if(typeof j!="undefined"){i+="#"+j}if(typeof g!="undefined"){i+="."+g.split(/[\s\n]+/).join(".")}return this.parent().getPath(" > "+i+h)}});e.Keen={Client:null,Debug:false,Callback:function(h,g,i){e.Keen.Client.addEvent(h,g,function(){if(e.Keen.Debug){console.log(h+": "+JSON.stringify(g))}if(i){i()}})},globalProperties:{keen:{addons:[{name:"keen:ip_to_geo",input:{ip:"ip_address"},output:"ip_geo_info"},{name:"keen:ua_parser",input:{ua_string:"user_agent"},output:"parsed_user_agent"},{name:"keen:url_parser",input:{url:"page_url"},output:"parsed_page_url"},{name:"keen:referrer_parser",input:{referrer_url:"referrer_url",page_url:"page_url"},output:"referrer_info"}]},ip_address:"${keen.ip}",user_agent:"${keen.user_agent}"}};window.CommonWeb=e})();